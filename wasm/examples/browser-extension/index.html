<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="./resources/style.css">
        <script type="module">
            import { log, stringify, currentNetwork } from './resources/utils.js';

            import * as kaspa from '../../web/kaspa/kaspa.js';
            let { Resolver, RpcClient, Encoding, kaspaToSompi } = kaspa;

            (async () => {
                await kaspa.default('../../web/kaspa/kaspa_bg.wasm');

                let networkId = currentNetwork();
                log(`Connecting to Kaspa network...`);
                log(`Selected network is ${networkId}...`);
                
                // const rpc = new RpcClient({
                //     resolver : new Resolver(),
                //     networkId,
                // });

                // await rpc.connect();
                // log("Connected to", rpc.url);
                
                // log("GetBlockDagInfo request...");
                // const info = await rpc.getBlockDagInfo();
                // log("GetBlockDagInfo response:", info);

                // log("Disconnected...");
                // await rpc.disconnect();


                let el = document.createElement("div");
                document.body.appendChild(el);
                el.innerHTML = `
                    <div id="connect" class="link">Connect wallet</div>
                    <br>&nbsp;<br>
                    <br/><input id="amount" class="amount" type="text" value="" placeholder=" Enter amount to request payment..." />
                    <br>&nbsp;<br>
                    <div id="request" class="link">Request payment</div>
                    <br>&nbsp;<br>
                `;

                let connect = document.getElementById("connect");
                submit.addEventListener("click", async (e) => {
                    e.preventDefault();
                    // TODO ... connect wallet
                });

                let request = document.getElementById("request");
                submit.addEventListener("click", async (e) => {
                    e.preventDefault();
                    let input = document.getElementById("amount");
                    let amount = input.value;
                    let sompi = kaspaToSompi(amount);
                    // TODO ... request payment
                    input.value = "";
                });

            })();

        </script>
    </head>
    <body></body>
</html>